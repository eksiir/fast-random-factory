# fast-random-factory
Yet another random number generator - Not!

It is a wrapper for your choice of random generator to cache and yield its results very fast when called repeatedly.
<br>
Consider an array of <strong>cacheSize</strong> elements,
<ol>
    <li>Each element of the array is a random number between min and max, generated by your choice of random <strong>object</strong> generator.</li>
    <li>The array is (optionally) shuffled.</li>
    <li>An element of that array is returned at every call.</li>
    <li>When all the elements are consumed, the cache array is recreated to provide an endless supply.</li>
</ol>

This factory is not limited to generating random numbers. Your customized <em>generator</em> may yeild any object.

## Install
Using npm:

    npm install fast-random-factory
     
## Usage

    const rngFactory = require('fast-random-factory');

The most basic usage is to use all defaults to generate random numbers between 
<ins>Number.MIN_SAFE_INTEGER</ins> and <ins>Number.MAX_SAFE_INTEGER</ins>

    var rng = rngFactory.create();
    var rand1 = rng.gen();
    ...
    var randN = rng.gen();
    
More creative use cases pass the <strong>options</strong> object which is elaborated below.

    var rng = rngFactory.create(options);
    if (rng.err) {
        console.error('Error: ' + rng.err.message);
    } else {
        var rand1 = rng.gen();
        ...
        var randN = rng.gen();
    }
    
The return value of the <strong>create()</strong> method is an object:

    { 
        err,
        config,
        cache(),
        cacheIndex(),
        refreshCache(),
        gen()
    }

In case of error, <em>err</em> is set to an instance of 
[Error](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Error) 
with its <em>message</em> field set to the reason.

In case of success,
  
  * <em>err</em> is null
  * the <em>gen()</em> method can be called repeatedly to yield random results
  * the <em>refreshCache()</em> method can be called at any time to discard the old cash and recreate new one    
<br>Useful for debugging:

  * the <em>config</em> readonly property contains the configurations resulting from processing the <em>options</em>
  * the <em>cache()</em> method returns the current cached randoms
  * the <em>cacheIndex()</em> method returns the current index in the cache

Also see example.js in the [module sources](https://github.com/eksiir/fast-random-factory)

## Dependencies 
This module depends on [underscore.js](http://underscorejs.org/) referred to as '_' in the following.
    
## The options Argument
The options object has the following fields and default values:
    
    {        
        min: Number.MIN_SAFE_INTEGER,
        max: Number.MAX_SAFE_INTEGER,
        
        generator: {
            func: _.random(),                   // from the underscore package
            args: [min, max],
            argsValidator: (min, max) => min should be < max
        },
        
        cacheSize: 1,
        shuffle: truthy,
        debug: falsy,
        logger: console.log
    }
    
Either the convenient syntax <strong>min, max</strong> should be used or the customizing <strong>generator</strong>
object. The latter rules, i.e. If the customized <em>generator</em> object is used, the convenient syntax <strong>min, max</strong> are ignored.
See example.js in the [module sources](https://github.com/eksiir/fast-random-factory)
 
### options.min
Ignored if the customized <em>generator</em> object is used.
Otherwise, the resultant random number is between this number and <strong>options.max</strong>.
<br>If the default generator is used, the result could be equal to this number.

### options.max
Ignored if the customized <em>generator</em> object is used.
Otherwise, the resultant random number is between <strong>options.min</strong> and this number.
<br>If the default generator is used, the result could be equal to this number.

### options.generator
If the default random number generator (i.e. _.random()) is not desirable, your choice can be used by customizing this object.
<br>
Note: this generator is not limited to random <em>numbers</em> and can generate any random <em>object</em>. 
 
#### options.generator.func
Your choice of random generator function which takes the 
<strong>options.generator.args</strong> 
array as arguments. 

#### options.generator.args
The arguments array passed to <strong>options.generator.func</strong>.


#### options.generator.argsValidator
 It validates the <strong>options.generator.args</strong> array;
     
         argsValidator(options.generator.args)
  
If all validations pass it should return null, otherwise it should return
[Error](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Error)
with its <em>message</em> field set to the cause of the error.

### options.cacheSize
This integer must be >= 1.

### options.shuffle
If set to truthy, the random array will be shuffled before it is doled out.
Setting this to falsy will speed up cache refreshes.

### options.debug
If set to truthy <strong>options.logger</strong> function is used to log debug messages.

### options.logger
Your choice of logging function which takes only a String argument.

## Seeding the Random Number Generator
The default random number generator ends up using 
[Math.random](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Math/random)
which "selects the initial seed to the random number generation algorithm; it cannot be chosen or reset by the user".
However, if it is desirable to explicitly seed the random number generator, use the custom 
<strong>options.generator</strong> object and seed it before its first usage. 

# License
The MIT License (MIT).

See the LICENSE file in this project for more details.

